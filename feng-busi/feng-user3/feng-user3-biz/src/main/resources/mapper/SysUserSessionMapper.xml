<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="work.metanet.feng.admin.mapper.SysUserSessionMapper">
    <!-- 结果集 -->
    <resultMap type="work.metanet.feng.admin.api.entity.SysUserSession" id="UserSessionMap">
        <result property="id" column="id"/>
        <result property="userId" column="user_id"/>
        <result property="sessionId" column="session_id"/>
        <result property="lastActive" column="last_active"/>
        <result property="status" column="status"/>
        <result property="createTime" column="create_time"/>
        <result property="updateTime" column="update_time"/>
    </resultMap>
    
    <!-- 基本字段 -->
    <sql id="Base_Column_List">id, user_id, session_id, last_active, status, create_time, update_time</sql>
    
    <!-- 根据会话ID查询会话信息 -->
    <select id="findBySessionId" resultMap="UserSessionMap">
        SELECT *
        FROM user_session
        WHERE session_id = #{sessionId}
    </select>
    
    <!-- 查询符合条件的记录数 -->
    <select id="countByLastActiveAfterAndStatus" resultType="java.lang.Integer">
        SELECT COUNT(*)
        FROM t_user_session
        WHERE last_active &gt; #{lastActive}
          AND status = #{status}
    </select>
</mapper>